/*
 Hype Action Events 1.1.1
copyright (c) 2022 Max Ziebell, (https://maxziebell.de). MIT-license
*/
!1==="HypeActionEvents"in window&&(window.HypeActionEvents=function(){function u(a){return a?w[a]:w}function A(a,e,l,c,p,f){if(-1!=u("MatterEvents").indexOf(p)&&e.querySelector("[data-"+f+"-action]"))Matter.Events.on(c,p,function(d){for(var b=d.pairs,h=0;h<b.length;h++){var n=document.getElementById(d.pairs[h].bodyA.elementId),r=document.getElementById(d.pairs[h].bodyB.elementId),g=n.getAttribute("data-"+f+"-action");g&&a.triggerAction(g,{element:n,event:Object.assign({type:d.name},d)});(g=r.getAttribute("data-"+
f+"-action"))&&a.triggerAction(g,{element:r,event:Object.assign({type:d.name},d)})}})}function x(a){return a.replaceAll(/[^a-zA-Z0-9\s]/g,"").replaceAll(/\s+/g,"-").toLowerCase()}var B="drag dragstart dragend dragover dragenter dragleave drop contextmenu keydown keypress keyup submit".split(" "),C="$ctx $doc $sym $elm $evt hypeDocument element event".split(" "),w={debug:!1,LegacyMode:!1,StrictMode:!1,MatterEvents:["collisionStart","collisionEnd","collisionActive"],DOMEvents:[].concat("mousedown mouseup click dblclick mouseover mousewheel mouseout mousemove touchstart touchmove touchend touchcancel change input beforeinput focusin focusout animationstart animationiteration animationend animationcancel transitionstart transitionrun transitionend transitioncancel pointerdown pointerup pointerover pointerout pointermove pointerenter pointerleave pointercancel".split(" ")).concat(B),
nonPassiveDOMEvents:B,WindowEvents:"resize focus blur beforeprint afterprint error storage online offline hashchange popstate message wheel".split(" "),DocumentEvents:["visibilitychange","scroll","fullscreenchange"]},k={};!1==="HYPE_eventListeners"in window&&(window.HYPE_eventListeners=[]);window.HYPE_eventListeners.push({type:"HypeDocumentLoad",callback:function(a,e,l){var c=a.documentId(),p=document.getElementById(c);k[a.documentId()]={rO:{},iO:{},mO:{},rAFiD:null,rAFsF:0,rAFtF:0,wE:{},dE:{}};u("DOMEvents").forEach(function(f){p.addEventListener(f,
function(d){var b=d.type,h=d.target.closest("#"+c+" [data-"+b+"-action]");h&&b&&(b=h.getAttribute("data-"+b+"-action"))&&a.triggerAction(b,{element:h,event:d})},{passive:-1==u("nonPassiveDOMEvents").indexOf(f)})});a.getSymbolInstance=function(f){for(var d=null;null==d&&null!=f;)d=a.getSymbolInstanceById(f.id),f=f.parentNode;return d};a.triggerAction=function(f,d){if(f){d=d||{};d=Object.assign({symbolInstance:a.getSymbolInstance(d.element),element:document.getElementById(a.currentSceneId()),event:{}},
d);var b=d.strictMode||u("StrictMode"),h=a.functions();if(!b){var n=Object.assign({},a,d.symbolInstance);if(u("LegacyMode")){var r={};Object.keys(h).forEach(function(g){r[g]=h[g].bind(a,a,d.element,d.event)});n=Object.assign(n,r)}else n=new Proxy(n,{set:function(g,m,t,q){return Reflect.get(g,m,q)?Reflect.set(g,m,t,q):Reflect.set(a.customData,m,t)},get:function(g,m,t){var q=Reflect.get(h,m);return q?q.bind(a,a,d.element,d.event):(g=Reflect.get(g,m,t))?g:Reflect.get(a.customData,m)},has:function(g,
m,t){return-1!==C.indexOf(m)?!1:Reflect.get(h,m)||!g.hasOwnProperty(m)&&!window[m]?!0:Reflect.has(g,m,t)}})}d.symbolInstance&&Object.assign(d.event,{symbolInstance:d.symbolInstance});try{return Function(C,n?"with($ctx){"+f+"}":b?'"use strict";'+f:f)(n,a,d.symbolInstance,d.element,d.event,a,d.element,d.event)}catch(g){(u("debug")||-1!=window.location.href.indexOf("127.0.0.1:")&&-1!=window.location.href.indexOf("/preview/"))&&console.error("%c"+(d.errorMsg||"Hype Action Events Error")+"%c"+(d.errorMsg?
"":" version "+D.version)+"\n\n%c"+f+(d.omitError?"":"%c\n\n"+g+"\n\n"),"font-size:12px; font-weight:bold","font-size:8px","min-height:40px;display: inline-block; padding: 10px; background-color: rgba(255,255,255,0.25); border: 1px solid lightgray; border-radius: 4px; font-family:Monospace; font-size:12px","font-size:11px",d.element?d.element:"")}}};a.triggerActionsByAttribute=function(f,d,b){d=d||document.getElementById(a.currentSceneId());b=b||{};d.querySelectorAll("["+f+"]").forEach(function(h){var n=
h.getAttribute(f);n&&a.triggerAction(n,Object.assign({element:h},b))})};a.querySelector=function(f){return document.getElementById(a.currentSceneId()).querySelector(f)};a.querySelectorAll=function(f){return document.getElementById(a.currentSceneId()).querySelectorAll(f)};"function"==typeof a.functions().HypeActionEvents&&a.functions().HypeActionEvents(a,e,l)}});window.HYPE_eventListeners.push({type:"HypeLayoutRequest",callback:function(a,e,l){a.triggerActionsByAttribute("data-layout-request-action",
e,{event:l})}});window.HYPE_eventListeners.push({type:"HypeScenePrepareForDisplay",callback:function(a,e,l){a.triggerActionsByAttribute("data-scene-prepare-action",e,{event:l})}});window.HYPE_eventListeners.push({type:"HypeSceneLoad",callback:function(a,e,l){var c=a.documentId(),p=document.getElementById(c);a.triggerActionsByAttribute("data-scene-load-action",e,{event:l});0!="Matter"in window&&u("MatterEvents")&&u("MatterEvents").length&&(p=a.getElementProperty(p,"physics-engine"),A(a,e,l,p,"collisionStart",
"collision-start"),A(a,e,l,p,"collisionActive","collision-active"),A(a,e,l,p,"collisionEnd","collision-end"));e.querySelectorAll("[data-resize-action]").forEach(function(b){k[c].rO[b.id]||(k[c].rO[b.id]=new ResizeObserver(function(n,r){var g=b.getAttribute("data-resize-action");g&&n.forEach(function(m,t){a.triggerAction(g,{element:b,event:{type:"ResizeObserver",entry:m,index:t,entries:n,observer:r}})})}));var h=b.getAttribute("data-resize-target");k[c].rO[b.id].observe(h||b)});e.querySelectorAll("[data-intersection-action]").forEach(function(b){if(!k[c].iO[b.id]){var h=
b.getAttribute("data-intersection-root"),n=b.getAttribute("data-intersection-margin"),r=b.getAttribute("data-intersection-threshold");r=r?r.replace(/\s\s+/g," ").split(" ").map(function(g){return-1!==g.indexOf("%")?parseFloat(g)/100:parseFloat(g)}):u("IntersectionTreshold")||null;k[c].iO[b.id]=new IntersectionObserver(function(g,m){var t=b.getAttribute("data-intersection-action");t&&g.forEach(function(q,y){var v=0;q.isIntersecting&&r&&(v=r.reduce(function(z,E){return Math.abs(E-q.intersectionRatio)<
Math.abs(z-q.intersectionRatio)?E:z}));null==q.rootBounds&&(q.rootBounds={top:0,bottom:window.innerHeight});a.triggerAction(t,{element:b,event:{type:"IntersectionObserver",entry:q,index:y,entries:g,observer:m,closestThreshold:v,closestThresholdPercent:100*v,inViewport:q.boundingClientRect.top<=q.rootBounds.bottom&&q.boundingClientRect.bottom>q.rootBounds.top,isAbove:q.boundingClientRect.top<q.rootBounds.top,isBelow:q.boundingClientRect.bottom>q.rootBounds.bottom+1}})})},{root:e.querySelector(h)||
null,rootMargin:n||"0px",threshold:r||null})}h=b.getAttribute("data-intersection-target");k[c].iO[b.id].observe(h||b)});e.querySelectorAll("[data-mutation-action]").forEach(function(b){k[c].mO[b.id]||(k[c].mO[b.id]=new MutationObserver(function(t,q){var y=b.getAttribute("data-mutation-action");y&&t.forEach(function(v,z){a.triggerAction(y,{element:b,event:{type:"MutationObserver",mutation:v,index:z,mutations:t,observer:q}})})}));var h="true"==b.getAttribute("data-mutation-child-list"),n="true"==b.getAttribute("data-mutation-attributes")||
!0,r="true"==b.getAttribute("data-mutation-character-data"),g="true"==b.getAttribute("data-mutation-subtree"),m=b.getAttribute("data-mutation-attribute-filter");m=m?m.split(",").map(function(t){return t.trim()}):u("AttributeFilter")||null;h={childList:h,attributes:n,characterData:r,subtree:g};m&&h.assign(h,{attributeFilter:m});m=b.getAttribute("data-mutation-target");k[c].mO[b.id].observe(m||b,h)});var f=e.querySelectorAll("[data-animation-frame-action]");if(f){k[c].rAFsF=0;var d=function(b){f.forEach(function(h){var n=
h.getAttribute("data-animation-frame-action");n&&a.triggerAction(n,{element:h,event:{type:"AnimationFrame",time:b,sceneFrames:k[c].rAFsF++,totalFrames:k[c].rAFtF++}})});k[c].rAFiD=requestAnimationFrame(d)};k[c].rAFiD=requestAnimationFrame(d)}u("WindowEvents").forEach(function(b){var h=e.querySelectorAll("[data-window-"+b+"-action]");h&&(k[c].wE[b]=function(n){var r=n.type;h.forEach(function(g){if(g&&r){var m=g.getAttribute("data-window-"+b+"-action");m&&a.triggerAction(m,{element:g,event:n})}})},
window.addEventListener(b,k[c].wE[b],{passive:!0}))});u("DocumentEvents").forEach(function(b){var h=e.querySelectorAll("[data-document-"+b+"-action]");h&&(k[c].dE[b]=function(n){var r=n.type;h.forEach(function(g){if(g&&r){var m=g.getAttribute("data-document-"+b+"-action");m&&a.triggerAction(m,{element:g,event:n})}})},document.addEventListener(b,k[c].dE[b],{passive:!0}))})}});window.HYPE_eventListeners.push({type:"HypeSceneUnload",callback:function(a,e,l){var c=a.documentId();a.triggerActionsByAttribute("data-scene-unload-action",
e,{event:l});for(var p in k[c].rO)e.querySelectorAll("[data-resize-action]").forEach(function(f){k[c].rO[p].unobserve(document.getElementById(f.id))});for(p in k[c].iO)e.querySelectorAll("[data-intersection-action]").forEach(function(f){k[c].iO[p].unobserve(document.getElementById(f.id))});for(p in k[c].mO)k[c].mO[p].disconnect();k[c].rAFiD&&(cancelAnimationFrame(k[c].rAFiD),k[c].rAFiD=null);u("WindowEvents").forEach(function(f){k[c].wE[f]&&(window.removeEventListener(f,k[c].wE[f]),delete k[c].wE[f])});
u("DocumentEvents").forEach(function(f){k[c].dE[f]&&(document.removeEventListener(f,k[c].dE[f]),delete k[c].dE[f])})}});window.HYPE_eventListeners.push({type:"HypeSymbolLoad",callback:function(a,e,l){var c=document.getElementById(a.currentSceneId()),p=a.getSymbolInstanceById(e.id).symbolName();if("function"==typeof a.functions()[p])a.functions()[p](a,e,Object.assign({proactiveEvent:!0},l));a.triggerActionsByAttribute("data-symbol-load-action",c,{event:l});e=x(p);a.triggerActionsByAttribute("data-symbol-load-"+
e+"-action",c,{event:l})}});window.HYPE_eventListeners.push({type:"HypeSymbolUnload",callback:function(a,e,l){var c=document.getElementById(a.currentSceneId()),p=a.getSymbolInstanceById(e.id).symbolName();if("function"==typeof a.functions()[p])a.functions()[p](a,e,Object.assign({proactiveEvent:!0},l));a.triggerActionsByAttribute("data-symbol-unload-action",c,{event:l});e=x(p);a.triggerActionsByAttribute("data-symbol-unload-"+e+"-action",c,{event:l})}});window.HYPE_eventListeners.push({type:"HypeTriggerCustomBehavior",
callback:function(a,e,l){var c=l.customBehaviorName;/[;=()]/.test(c)?"#"!=c.charAt(0)&&a.triggerAction(c,{element:e,event:l}):(e=document.getElementById(a.currentSceneId()),a.triggerActionsByAttribute("data-behavior-action",e,{event:l}),c=x(l.customBehaviorName),a.triggerActionsByAttribute("data-behavior-"+c+"-action",e,{event:l}))}});window.HYPE_eventListeners.push({type:"HypeTimelineComplete",callback:function(a,e,l){e=document.getElementById(a.currentSceneId());a.triggerActionsByAttribute("data-timeline-complete-action",
e,{event:l});var c=x(l.timelineName);a.triggerActionsByAttribute("data-timeline-complete-"+c+"-action",e,{event:l})}});var D={version:"1.1.1",getDefault:u,setDefault:function(a,e){"object"==typeof a?w=a:w[a]=e}};return D}());
