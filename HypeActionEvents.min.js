/*
 Hype Action Events 1.0.9
copyright (c) 2022 Max Ziebell, (https://maxziebell.de). MIT-license
*/
!1==="HypeActionEvents"in window&&(window.HypeActionEvents=function(){function t(a){return a?w[a]:w}function A(a,e,l,c,p,g){if(-1!=t("MatterEvents").indexOf(p)&&e.querySelector("[data-"+g+"-action]"))Matter.Events.on(c,p,function(d){for(var b=d.pairs,h=0;h<b.length;h++){var n=document.getElementById(d.pairs[h].bodyA.elementId),q=document.getElementById(d.pairs[h].bodyB.elementId),f=n.getAttribute("data-"+g+"-action");f&&a.triggerAction(f,{element:n,event:Object.assign({type:d.name},d)});(f=q.getAttribute("data-"+
g+"-action"))&&a.triggerAction(f,{element:q,event:Object.assign({type:d.name},d)})}})}function x(a){return a.replaceAll(/[^a-zA-Z0-9\s]/g,"").replaceAll(/\s+/g,"-").toLowerCase()}var B="drag dragstart dragend dragover dragenter dragleave drop contextmenu keydown keypress keyup submit".split(" "),C="$ctx $doc $sym $elm $evt hypeDocument element event".split(" "),w={debug:!1,LegacyMode:!1,StrictMode:!1,MatterEvents:["collisionStart","collisionEnd","collisionActive"],DOMEvents:[].concat("mousedown mouseup click dblclick mouseover mousewheel mouseout mousemove touchstart touchmove touchend touchcancel change input beforeinput focusin focusout animationstart animationiteration animationend animationcancel transitionstart transitionrun transitionend transitioncancel pointerdown pointerup pointerover pointerout pointermove pointerenter pointerleave pointercancel".split(" ")).concat(B),
nonPassiveDOMEvents:B,WindowEvents:"resize focus blur beforeprint afterprint error storage online offline hashchange popstate message wheel".split(" "),DocumentEvents:["visibilitychange","scroll","fullscreenchange"]},k={};!1==="HYPE_eventListeners"in window&&(window.HYPE_eventListeners=[]);window.HYPE_eventListeners.push({type:"HypeDocumentLoad",callback:function(a,e,l){var c=a.documentId(),p=document.getElementById(c);k[a.documentId()]={rO:{},iO:{},mO:{},rAFiD:null,rAFsF:0,rAFtF:0,wE:{},dE:{}};t("DOMEvents").forEach(function(g){p.addEventListener(g,
function(d){var b=d.type,h=d.target.closest("#"+c+" [data-"+b+"-action]");h&&b&&(b=h.getAttribute("data-"+b+"-action"))&&a.triggerAction(b,{element:h,event:d})},{passive:-1==t("nonPassiveDOMEvents").indexOf(g)})});a.getSymbolInstance=function(g){for(var d=null;null==d&&null!=g;)d=a.getSymbolInstanceById(g.id),g=g.parentNode;return d};a.triggerAction=function(g,d){if(g){d=d||{};d=Object.assign({symbolInstance:a.getSymbolInstance(d.element),element:document.getElementById(a.currentSceneId()),event:{}},
d);var b=d.strictMode||t("StrictMode"),h=a.functions();if(!b){var n=Object.assign({},a,d.symbolInstance);if(t("LegacyMode")){var q={};Object.keys(h).forEach(function(f){q[f]=h[f].bind(a,a,d.element,d.event)});n=Object.assign(n,q)}else n=new Proxy(n,{set:function(f,m,r,u){return Reflect.get(f,m,u)?Reflect.set(f,m,r,u):Reflect.set(a.customData,m,r)},get:function(f,m,r){var u=Reflect.get(h,m);return u?u.bind(a,a,d.element,d.event):(f=Reflect.get(f,m,r))?f:Reflect.get(a.customData,m)},has:function(f,
m,r){return-1!==C.indexOf(m)?!1:Reflect.get(h,m)||!f.hasOwnProperty(m)&&!window[m]?!0:Reflect.has(f,m,r)}})}d.symbolInstance&&Object.assign(d.event,{symbolInstance:d.symbolInstance});try{return Function(C,n?"with($ctx){"+g+"}":b?'"use strict";'+g:g)(n,a,d.symbolInstance,d.element,d.event,a,d.element,d.event)}catch(f){(t("debug")||-1!=window.location.href.indexOf("127.0.0.1:")&&-1!=window.location.href.indexOf("/preview/"))&&console.error("%c"+(d.errorMsg||"Hype Action Events Error")+"%c"+(d.errorMsg?
"":" version "+D.version)+"\n\n%c"+g+(d.omitError?"":"%c\n\n"+f+"\n\n"),"font-size:12px; font-weight:bold","font-size:8px","min-height:40px;display: inline-block; padding: 10px; background-color: rgba(255,255,255,0.25); border: 1px solid lightgray; border-radius: 4px; font-family:Monospace; font-size:12px","font-size:11px",d.element?d.element:"")}}};a.triggerActionsByAttribute=function(g,d,b){d=d||document.getElementById(a.currentSceneId());b=b||{};d.querySelectorAll("["+g+"]").forEach(function(h){var n=
h.getAttribute(g);n&&a.triggerAction(n,Object.assign({element:h},b))})};"function"==typeof a.functions().HypeActionEvents&&a.functions().HypeActionEvents(a,e,l)}});window.HYPE_eventListeners.push({type:"HypeLayoutRequest",callback:function(a,e,l){a.triggerActionsByAttribute("data-layout-request-action",e,{event:l})}});window.HYPE_eventListeners.push({type:"HypeScenePrepareForDisplay",callback:function(a,e,l){a.triggerActionsByAttribute("data-scene-prepare-action",e,{event:l})}});window.HYPE_eventListeners.push({type:"HypeSceneLoad",
callback:function(a,e,l){var c=a.documentId(),p=document.getElementById(c);a.triggerActionsByAttribute("data-scene-load-action",e,{event:l});0!="Matter"in window&&t("MatterEvents")&&t("MatterEvents").length&&(p=a.getElementProperty(p,"physics-engine"),A(a,e,l,p,"collisionStart","collision-start"),A(a,e,l,p,"collisionActive","collision-active"),A(a,e,l,p,"collisionEnd","collision-end"));e.querySelectorAll("[data-resize-action]").forEach(function(b){k[c].rO[b.id]||(k[c].rO[b.id]=new ResizeObserver(function(n,
q){var f=b.getAttribute("data-resize-action");f&&n.forEach(function(m,r){a.triggerAction(f,{element:b,event:{type:"ResizeObserver",entry:m,index:r,entries:n,observer:q}})})}));var h=b.getAttribute("data-resize-target");k[c].rO[b.id].observe(h||b)});e.querySelectorAll("[data-intersection-action]").forEach(function(b){if(!k[c].iO[b.id]){var h=b.getAttribute("data-intersection-root"),n=b.getAttribute("data-intersection-margin"),q=b.getAttribute("data-intersection-threshold");q=q?q.replace(/\s\s+/g," ").split(" ").map(function(f){return-1!==
f.indexOf("%")?parseFloat(f)/100:parseFloat(f)}):t("IntersectionTreshold")||null;k[c].iO[b.id]=new IntersectionObserver(function(f,m){var r=b.getAttribute("data-intersection-action");r&&f.forEach(function(u,y){var v=0;u.isIntersecting&&q&&(v=q.reduce(function(z,E){return Math.abs(E-u.intersectionRatio)<Math.abs(z-u.intersectionRatio)?E:z}));a.triggerAction(r,{element:b,event:{type:"IntersectionObserver",entry:u,index:y,entries:f,observer:m,closestThreshold:v,closestThresholdPercent:100*v,isAbove:u.boundingClientRect.y<
u.rootBounds.y}})})},{root:e.querySelector(h)||null,rootMargin:n||"0px",threshold:q||null})}h=b.getAttribute("data-intersection-target");k[c].iO[b.id].observe(h||b)});e.querySelectorAll("[data-mutation-action]").forEach(function(b){k[c].mO[b.id]||(k[c].mO[b.id]=new MutationObserver(function(r,u){var y=b.getAttribute("data-mutation-action");y&&r.forEach(function(v,z){a.triggerAction(y,{element:b,event:{type:"MutationObserver",mutation:v,index:z,mutations:r,observer:u}})})}));var h="true"==b.getAttribute("data-mutation-child-list"),
n="true"==b.getAttribute("data-mutation-attributes")||!0,q="true"==b.getAttribute("data-mutation-character-data"),f="true"==b.getAttribute("data-mutation-subtree"),m=b.getAttribute("data-mutation-attribute-filter");m=m?m.split(",").map(function(r){return r.trim()}):t("AttributeFilter")||null;h={childList:h,attributes:n,characterData:q,subtree:f};m&&h.assign(h,{attributeFilter:m});m=b.getAttribute("data-mutation-target");k[c].mO[b.id].observe(m||b,h)});var g=e.querySelectorAll("[data-animation-frame-action]");
if(g){k[c].rAFsF=0;var d=function(b){g.forEach(function(h){var n=h.getAttribute("data-animation-frame-action");n&&a.triggerAction(n,{element:h,event:{type:"AnimationFrame",time:b,sceneFrames:k[c].rAFsF++,totalFrames:k[c].rAFtF++}})});k[c].rAFiD=requestAnimationFrame(d)};k[c].rAFiD=requestAnimationFrame(d)}t("WindowEvents").forEach(function(b){var h=e.querySelectorAll("[data-window-"+b+"-action]");h&&(k[c].wE[b]=function(n){var q=n.type;h.forEach(function(f){if(f&&q){var m=f.getAttribute("data-window-"+
b+"-action");m&&a.triggerAction(m,{element:f,event:n})}})},window.addEventListener(b,k[c].wE[b],{passive:!0}))});t("DocumentEvents").forEach(function(b){var h=e.querySelectorAll("[data-document-"+b+"-action]");h&&(k[c].dE[b]=function(n){var q=n.type;h.forEach(function(f){if(f&&q){var m=f.getAttribute("data-document-"+b+"-action");m&&a.triggerAction(m,{element:f,event:n})}})},document.addEventListener(b,k[c].dE[b],{passive:!0}))})}});window.HYPE_eventListeners.push({type:"HypeSceneUnload",callback:function(a,
e,l){var c=a.documentId();a.triggerActionsByAttribute("data-scene-unload-action",e,{event:l});for(var p in k[c].rO)e.querySelectorAll("[data-resize-action]").forEach(function(g){k[c].rO[p].unobserve(document.getElementById(g.id))});for(p in k[c].iO)e.querySelectorAll("[data-intersection-action]").forEach(function(g){k[c].iO[p].unobserve(document.getElementById(g.id))});for(p in k[c].mO)k[c].mO[p].disconnect();k[c].rAFiD&&(cancelAnimationFrame(k[c].rAFiD),k[c].rAFiD=null);t("WindowEvents").forEach(function(g){k[c].wE[g]&&
(window.removeEventListener(g,k[c].wE[g]),delete k[c].wE[g])});t("DocumentEvents").forEach(function(g){k[c].dE[g]&&(document.removeEventListener(g,k[c].dE[g]),delete k[c].dE[g])})}});window.HYPE_eventListeners.push({type:"HypeSymbolLoad",callback:function(a,e,l){var c=document.getElementById(a.currentSceneId()),p=a.getSymbolInstanceById(e.id).symbolName();if("function"==typeof a.functions()[p])a.functions()[p](a,e,Object.assign({proactiveEvent:!0},l));a.triggerActionsByAttribute("data-symbol-load-action",
c,{event:l});e=x(p);a.triggerActionsByAttribute("data-symbol-load-"+e+"-action",c,{event:l})}});window.HYPE_eventListeners.push({type:"HypeSymbolUnload",callback:function(a,e,l){var c=document.getElementById(a.currentSceneId()),p=a.getSymbolInstanceById(e.id).symbolName();if("function"==typeof a.functions()[p])a.functions()[p](a,e,Object.assign({proactiveEvent:!0},l));a.triggerActionsByAttribute("data-symbol-unload-action",c,{event:l});e=x(p);a.triggerActionsByAttribute("data-symbol-unload-"+e+"-action",
c,{event:l})}});window.HYPE_eventListeners.push({type:"HypeTriggerCustomBehavior",callback:function(a,e,l){var c=l.customBehaviorName;/[;=()]/.test(c)?a.triggerAction(c,{element:e,event:l}):(e=document.getElementById(a.currentSceneId()),a.triggerActionsByAttribute("data-behavior-action",e,{event:l}),c=x(l.customBehaviorName),a.triggerActionsByAttribute("data-behavior-"+c+"-action",e,{event:l}))}});window.HYPE_eventListeners.push({type:"HypeTimelineComplete",callback:function(a,e,l){e=document.getElementById(a.currentSceneId());
a.triggerActionsByAttribute("data-timeline-complete-action",e,{event:l});var c=x(l.timelineName);a.triggerActionsByAttribute("data-timeline-complete-"+c+"-action",e,{event:l})}});var D={version:"1.0.9",getDefault:t,setDefault:function(a,e){"object"==typeof a?w=a:w[a]=e}};return D}());
