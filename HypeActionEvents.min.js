/*
 Hype Action Events 1.1.5
copyright (c) 2025 Max Ziebell, (https://maxziebell.de). MIT-license
*/
'use strict';!1==="HypeActionEvents"in window&&(window.HypeActionEvents=function(){function u(a){return a?x[a]:x}function A(a,e,l,c,p,f){if(-1!=u("MatterEvents").indexOf(p)&&e.querySelector("[data-"+f+"-action]"))Matter.Events.on(c,p,function(d){for(var b=d.pairs,h=0;h<b.length;h++){var n=document.getElementById(d.pairs[h].bodyA.elementId),q=document.getElementById(d.pairs[h].bodyB.elementId),g=n.getAttribute("data-"+f+"-action");g&&a.triggerAction(g,{element:n,event:Object.assign({type:d.name},d)});
(g=q.getAttribute("data-"+f+"-action"))&&a.triggerAction(g,{element:q,event:Object.assign({type:d.name},d)})}})}function y(a){return a.replaceAll(/[^a-zA-Z0-9\s]/g,"").replaceAll(/\s+/g,"-").toLowerCase()}var B="drag dragstart dragend dragover dragenter dragleave drop contextmenu keydown keypress keyup submit".split(" "),C="$ctx $doc $sym $elm $evt hypeDocument element event".split(" "),x={debug:!1,LegacyMode:!1,StrictMode:!1,MatterEvents:["collisionStart","collisionEnd","collisionActive"],DOMEvents:[].concat("mousedown mouseup click dblclick mouseover mousewheel mouseout mousemove touchstart touchmove touchend touchcancel change input beforeinput focusin focusout animationstart animationiteration animationend animationcancel transitionstart transitionrun transitionend transitioncancel pointerdown pointerup pointerover pointerout pointermove pointerenter pointerleave pointercancel".split(" ")).concat(B),
nonPassiveDOMEvents:B,WindowEvents:"resize focus blur beforeprint afterprint error storage online offline hashchange popstate message wheel".split(" "),DocumentEvents:["visibilitychange","scroll","fullscreenchange"]},k={};!1==="HYPE_eventListeners"in window&&(window.HYPE_eventListeners=[]);window.HYPE_eventListeners.push({type:"HypeDocumentLoad",callback:function(a,e,l){var c=a.documentId(),p=document.getElementById(c);k[a.documentId()]={rO:{},iO:{},mO:{},rAFiD:null,rAFsF:0,rAFtF:0,wE:{},dE:{}};u("DOMEvents").forEach(function(f){p.addEventListener(f,
function(d){var b=d.type,h=d.target.closest("#"+c+" [data-"+b+"-action]");h&&b&&(b=h.getAttribute("data-"+b+"-action"))&&a.triggerAction(b,{element:h,event:d})},{passive:-1==u("nonPassiveDOMEvents").indexOf(f)})});a.getSymbolInstance=function(f){for(var d=null;null==d&&null!=f;)d=a.getSymbolInstanceById(f.id),f=f.parentNode;return d};a.triggerAction=function(f,d){if(f){d=d||{};d=Object.assign({symbolInstance:a.getSymbolInstance(d.element),element:document.getElementById(a.currentSceneId()),event:{},
scope:a.customData},d);var b=d.strictMode||u("StrictMode"),h=a.functions();if(!b){var n=Object.assign({},a,d.symbolInstance);if(u("LegacyMode")){var q={};Object.keys(h).forEach(function(g){q[g]=h[g].bind(a,a,d.element,d.event)});n=Object.assign(n,q)}else n=new Proxy(n,{set(g,m,t,r){return Reflect.get(g,m,r)?Reflect.set(g,m,t,r):Reflect.set(d.scope,m,t)},get(g,m,t){var r=Reflect.get(h,m);return r?r.bind(a,a,d.element,d.event):(g=Reflect.get(g,m,t))?g:Reflect.get(d.scope,m)},has(g,m,t){return-1!==C.indexOf(m)?
!1:Reflect.get(h,m)||!g.hasOwnProperty(m)&&!window[m]?!0:Reflect.has(g,m,t)}})}d.symbolInstance&&Object.assign(d.event,{symbolInstance:d.symbolInstance});try{return Function(C,n?"with($ctx){"+f+"}":b?'"use strict";'+f:f)(n,a,d.symbolInstance,d.element,d.event,a,d.element,d.event)}catch(g){(u("debug")||-1!=window.location.href.indexOf("127.0.0.1:")&&-1!=window.location.href.indexOf("/preview/"))&&console.error("%c"+(d.errorMsg||"Hype Action Events Error")+"%c"+(d.errorMsg?"":" version "+D.version)+
"\n\n%c"+f+(d.omitError?"":"%c\n\n"+g+"\n\n"),"font-size:12px; font-weight:bold","font-size:8px","min-height:40px;display: inline-block; padding: 10px; background-color: rgba(255,255,255,0.25); border: 1px solid lightgray; border-radius: 4px; font-family:Monospace; font-size:12px","font-size:11px",d.element?d.element:"")}}};a.triggerActionsByAttribute=function(f,d,b){d=d||document.getElementById(a.currentSceneId());b=b||{};d.querySelectorAll("["+f+"]").forEach(function(h){var n=h.getAttribute(f);
n&&a.triggerAction(n,Object.assign({element:h},b))})};a.querySelector=function(f){return document.getElementById(a.currentSceneId()).querySelector(f)};a.querySelectorAll=function(f){return document.getElementById(a.currentSceneId()).querySelectorAll(f)};"function"==typeof a.functions().HypeActionEvents&&a.functions().HypeActionEvents(a,e,l)}});window.HYPE_eventListeners.unshift({type:"HypeLayoutRequest",callback:function(a,e,l){a.triggerActionsByAttribute&&a.triggerActionsByAttribute("data-layout-request-action",
e,{event:l})}});window.HYPE_eventListeners.push({type:"HypeScenePrepareForDisplay",callback:function(a,e,l){a.triggerActionsByAttribute("data-scene-prepare-action",e,{event:l})}});window.HYPE_eventListeners.push({type:"HypeSceneLoad",callback:function(a,e,l){var c=a.documentId(),p=document.getElementById(c);a.triggerActionsByAttribute("data-scene-load-action",e,{event:l});0!="Matter"in window&&u("MatterEvents")&&u("MatterEvents").length&&(p=a.getElementProperty(p,"physics-engine"),A(a,e,l,p,"collisionStart",
"collision-start"),A(a,e,l,p,"collisionActive","collision-active"),A(a,e,l,p,"collisionEnd","collision-end"));e.querySelectorAll("[data-resize-action]").forEach(function(b){k[c].rO[b.id]||(k[c].rO[b.id]=new ResizeObserver(function(n,q){var g=b.getAttribute("data-resize-action");g&&n.forEach(function(m,t){a.triggerAction(g,{element:b,event:{type:"ResizeObserver",entry:m,index:t,entries:n,observer:q}})})}));var h=b.getAttribute("data-resize-target");k[c].rO[b.id].observe(h||b)});e.querySelectorAll("[data-intersection-action]").forEach(function(b){if(!k[c].iO[b.id]){var h=
b.getAttribute("data-intersection-root"),n=b.getAttribute("data-intersection-margin"),q=b.getAttribute("data-intersection-threshold");q=q?q.replace(/\s\s+/g," ").split(" ").map(function(g){return-1!==g.indexOf("%")?parseFloat(g)/100:parseFloat(g)}):u("IntersectionTreshold")||null;k[c].iO[b.id]=new IntersectionObserver(function(g,m){var t=b.getAttribute("data-intersection-action");t&&g.forEach(function(r,z){var w=0;r.isIntersecting&&q&&(w=q.reduce(function(E,F){return Math.abs(F-r.intersectionRatio)<
Math.abs(E-r.intersectionRatio)?F:E}));var v=r.rootBounds||{top:0,bottom:window.innerHeight||0};a.triggerAction(t,{element:b,event:{type:"IntersectionObserver",entry:r,index:z,entries:g,observer:m,closestThreshold:w,closestThresholdPercent:100*w,inViewport:r.boundingClientRect.top<=v.bottom&&r.boundingClientRect.bottom>v.top,isAbove:r.boundingClientRect.top<v.top,isBelow:r.boundingClientRect.bottom>v.bottom+1}})})},{root:e.querySelector(h)||null,rootMargin:n||"0px",threshold:q||null})}h=b.getAttribute("data-intersection-target");
k[c].iO[b.id].observe(h||b)});e.querySelectorAll("[data-mutation-action]").forEach(function(b){k[c].mO[b.id]||(k[c].mO[b.id]=new MutationObserver(function(t,r){var z=b.getAttribute("data-mutation-action");z&&t.forEach(function(w,v){a.triggerAction(z,{element:b,event:{type:"MutationObserver",mutation:w,index:v,mutations:t,observer:r}})})}));var h="true"==b.getAttribute("data-mutation-child-list"),n="true"==b.getAttribute("data-mutation-attributes")||!0,q="true"==b.getAttribute("data-mutation-character-data"),
g="true"==b.getAttribute("data-mutation-subtree"),m=b.getAttribute("data-mutation-attribute-filter");m=m?m.split(",").map(function(t){return t.trim()}):u("AttributeFilter")||null;h={childList:h,attributes:n,characterData:q,subtree:g};m&&h.assign(h,{attributeFilter:m});m=b.getAttribute("data-mutation-target");k[c].mO[b.id].observe(m||b,h)});var f=e.querySelectorAll("[data-animation-frame-action]");if(f){k[c].rAFsF=0;var d=function(b){f.forEach(function(h){var n=h.getAttribute("data-animation-frame-action");
n&&a.triggerAction(n,{element:h,event:{type:"AnimationFrame",time:b,sceneFrames:k[c].rAFsF++,totalFrames:k[c].rAFtF++}})});k[c].rAFiD=requestAnimationFrame(d)};k[c].rAFiD=requestAnimationFrame(d)}u("WindowEvents").forEach(function(b){var h=e.querySelectorAll("[data-window-"+b+"-action]");h&&(k[c].wE[b]=function(n){var q=n.type;h.forEach(function(g){if(g&&q){var m=g.getAttribute("data-window-"+b+"-action");m&&a.triggerAction(m,{element:g,event:n})}})},window.addEventListener(b,k[c].wE[b],{passive:!0}))});
u("DocumentEvents").forEach(function(b){var h=e.querySelectorAll("[data-document-"+b+"-action]");h&&(k[c].dE[b]=function(n){var q=n.type;h.forEach(function(g){if(g&&q){var m=g.getAttribute("data-document-"+b+"-action");m&&a.triggerAction(m,{element:g,event:n})}})},document.addEventListener(b,k[c].dE[b],{passive:!0}))})}});window.HYPE_eventListeners.push({type:"HypeSceneUnload",callback:function(a,e,l){var c=a.documentId();a.triggerActionsByAttribute("data-scene-unload-action",e,{event:l});for(var p in k[c].rO)e.querySelectorAll("[data-resize-action]").forEach(function(f){k[c].rO[p].unobserve(document.getElementById(f.id))});
for(p in k[c].iO)e.querySelectorAll("[data-intersection-action]").forEach(function(f){k[c].iO[p].unobserve(document.getElementById(f.id))});for(p in k[c].mO)k[c].mO[p].disconnect();k[c].rAFiD&&(cancelAnimationFrame(k[c].rAFiD),k[c].rAFiD=null);u("WindowEvents").forEach(function(f){k[c].wE[f]&&(window.removeEventListener(f,k[c].wE[f]),delete k[c].wE[f])});u("DocumentEvents").forEach(function(f){k[c].dE[f]&&(document.removeEventListener(f,k[c].dE[f]),delete k[c].dE[f])})}});window.HYPE_eventListeners.push({type:"HypeSymbolLoad",
callback:function(a,e,l){var c=document.getElementById(a.currentSceneId()),p=a.getSymbolInstanceById(e.id).symbolName();if("function"==typeof a.functions()[p])a.functions()[p](a,e,Object.assign({proactiveEvent:!0},l));a.triggerActionsByAttribute("data-symbol-load-action",c,{event:l});e=y(p);a.triggerActionsByAttribute("data-symbol-load-"+e+"-action",c,{event:l})}});window.HYPE_eventListeners.push({type:"HypeSymbolUnload",callback:function(a,e,l){var c=document.getElementById(a.currentSceneId()),p=
a.getSymbolInstanceById(e.id).symbolName();if("function"==typeof a.functions()[p])a.functions()[p](a,e,Object.assign({proactiveEvent:!0},l));a.triggerActionsByAttribute("data-symbol-unload-action",c,{event:l});e=y(p);a.triggerActionsByAttribute("data-symbol-unload-"+e+"-action",c,{event:l})}});window.HYPE_eventListeners.push({type:"HypeTriggerCustomBehavior",callback:function(a,e,l){var c=l.customBehaviorName;/[;=()]/.test(c)?"#"!=c.charAt(0)&&a.triggerAction(c,{element:e,event:l}):(e=document.getElementById(a.currentSceneId()),
a.triggerActionsByAttribute("data-behavior-action",e,{event:l}),c=y(l.customBehaviorName),a.triggerActionsByAttribute("data-behavior-"+c+"-action",e,{event:l}))}});window.HYPE_eventListeners.push({type:"HypeTimelineComplete",callback:function(a,e,l){e=document.getElementById(a.currentSceneId());a.triggerActionsByAttribute("data-timeline-complete-action",e,{event:l});var c=y(l.timelineName);a.triggerActionsByAttribute("data-timeline-complete-"+c+"-action",e,{event:l})}});var D={version:"1.1.5",getDefault:u,
setDefault:function(a,e){"object"==typeof a?x=a:x[a]=e}};return D}());
