/*
 Hype Action Events 1.0.7
copyright (c) 2022 Max Ziebell, (https://maxziebell.de). MIT-license
*/
!1==="HypeActionEvents"in window&&(window.HypeActionEvents=function(){function r(a){return a?w[a]:w}function A(a,e,l,d,f,c){if(-1!=r("MatterEvents").indexOf(f)&&e.querySelector("[data-"+c+"-action]"))Matter.Events.on(d,f,function(n){for(var b=n.pairs,m=0;m<b.length;m++){var q=document.getElementById(n.pairs[m].bodyA.elementId),k=document.getElementById(n.pairs[m].bodyB.elementId),g=q.getAttribute("data-"+c+"-action");g&&a.triggerAction(g,{element:q,event:Object.assign({type:n.name},n)});(g=k.getAttribute("data-"+
c+"-action"))&&a.triggerAction(g,{element:k,event:Object.assign({type:n.name},n)})}})}function x(a){return a.replaceAll(/[^a-zA-Z0-9\s]/g,"").replaceAll(/\s+/g,"-").toLowerCase()}var B="drag dragstart dragend dragover dragenter dragleave drop".split(" "),C="$ctx $doc $sym $elm $evt hypeDocument element event".split(" "),w={debug:!1,LegacyMode:!1,StrictMode:!1,MatterEvents:["collisionStart","collisionEnd","collisionActive"],DOMEvents:"mousedown mouseup click dblclick mouseover mousewheel mouseout contextmenu mousemove touchstart touchmove touchend touchcancel keydown keypress keyup focus blur change submit input beforeinput animationstart animationiteration animationend animationcancel transitionstart transitionrun transitionend transitioncancel pointerdown pointerup pointerover pointerout pointermove pointerenter pointerleave pointercancel".split(" ").concat(B),
nonPassiveDOMEvents:B,WindowEvents:"resize focus blur beforeprint afterprint error storage online offline hashchange popstate message wheel".split(" "),DocumentEvents:["visibilitychange","scroll","fullscreenchange"]},h={};!1==="HYPE_eventListeners"in window&&(window.HYPE_eventListeners=[]);window.HYPE_eventListeners.push({type:"HypeDocumentLoad",callback:function(a,e,l){var d=document.getElementById(a.documentId());h[a.documentId()]={rO:{},iO:{},mO:{},rAFiD:null,rAFsF:0,rAFtF:0,wE:{},dE:{}};r("DOMEvents").forEach(function(f){d.addEventListener(f,
function(c){var n=c.target,b=c.type;n&&b&&(b=n.getAttribute("data-"+b+"-action"))&&a.triggerAction(b,{element:n,event:c})},{passive:-1==r("nonPassiveDOMEvents").indexOf(f)})});a.getSymbolInstance=function(f){for(var c=null;null==c&&null!=f;)c=a.getSymbolInstanceById(f.id),f=f.parentNode;return c};a.triggerAction=function(f,c){if(f){c=c||{};c=Object.assign({symbolInstance:a.getSymbolInstance(c.element),element:document.getElementById(a.currentSceneId()),event:{}},c);var n=c.strictMode||r("StrictMode");
if(!n){var b=Object.assign({},a,c.symbolInstance);if(r("LegacyMode")){var m={},q=a.functions();Object.keys(q).forEach(function(k){m[k]=q[k].bind(a,a,c.element,c.event)});b=Object.assign(b,m)}else b=new Proxy(b,{set:function(k,g,p,t){return Reflect.get(k,g,t)?Reflect.set(k,g,p,t):Reflect.set(a.customData,g,p)},get:function(k,g,p){var t=Reflect.get(a.functions(),g);return t?t.bind(a,a,c.element,c.event):(k=Reflect.get(k,g,p))?k:Reflect.get(a.customData,g)},has:function(k,g,p){return-1!==C.indexOf(g)?
!1:k.hasOwnProperty(g)||window[g]?Reflect.has(k,g,p):!0}})}c.symbolInstance&&Object.assign(c.event,{symbolInstance:c.symbolInstance});try{return Function(C,b?"with($ctx){"+f+"}":n?'"use strict";'+f:f)(b,a,c.symbolInstance,c.element,c.event,a,c.element,c.event)}catch(k){(r("debug")||-1!=window.location.href.indexOf("127.0.0.1:")&&-1!=window.location.href.indexOf("/preview/"))&&console.error("%c"+(c.errorMsg||"Hype Action Events Error")+"%c"+(c.errorMsg?"":" version "+D.version)+"\n\n%c"+f+(c.omitError?
"":"%c\n\n"+k+"\n\n"),"font-size:12px; font-weight:bold","font-size:8px","min-height:40px;display: inline-block; padding: 10px; background-color: rgba(255,255,255,0.25); border: 1px solid lightgray; border-radius: 4px; font-family:Monospace; font-size:12px","font-size:11px",c.element?c.element:"")}}};a.triggerActionsByAttribute=function(f,c,n){c=c||document.getElementById(a.currentSceneId());n=n||{};c.querySelectorAll("["+f+"]").forEach(function(b){var m=b.getAttribute(f);m&&a.triggerAction(m,Object.assign({element:b},
n))})};"function"==typeof a.functions().HypeActionEvents&&a.functions().HypeActionEvents(a,e,l)}});window.HYPE_eventListeners.push({type:"HypeLayoutRequest",callback:function(a,e,l){a.triggerActionsByAttribute("data-layout-request-action",e,{event:l})}});window.HYPE_eventListeners.push({type:"HypeScenePrepareForDisplay",callback:function(a,e,l){a.triggerActionsByAttribute("data-scene-prepare-action",e,{event:l})}});window.HYPE_eventListeners.push({type:"HypeSceneLoad",callback:function(a,e,l){var d=
a.documentId(),f=document.getElementById(d);0!="Matter"in window&&r("MatterEvents")&&r("MatterEvents").length&&(f=a.getElementProperty(f,"physics-engine"),A(a,e,l,f,"collisionStart","collision-start"),A(a,e,l,f,"collisionActive","collision-active"),A(a,e,l,f,"collisionEnd","collision-end"));a.triggerActionsByAttribute("data-scene-load-action",e,{event:l});e.querySelectorAll("[data-resize-action]").forEach(function(b){h[d].rO[b.id]||(h[d].rO[b.id]=new ResizeObserver(function(q,k){var g=b.getAttribute("data-resize-action");
g&&q.forEach(function(p,t){a.triggerAction(g,{element:b,event:{type:"ResizeObserver",entry:p,index:t,entries:q,observer:k}})})}));var m=b.getAttribute("data-resize-target");h[d].rO[b.id].observe(m||b)});e.querySelectorAll("[data-intersection-action]").forEach(function(b){if(!h[d].iO[b.id]){var m=b.getAttribute("data-intersection-root"),q=b.getAttribute("data-intersection-margin"),k=b.getAttribute("data-intersection-threshold");k=k?k.replace(/\s\s+/g," ").split(" ").map(function(g){return-1!==g.indexOf("%")?
parseFloat(g)/100:parseFloat(g)}):r("IntersectionTreshold")||null;h[d].iO[b.id]=new IntersectionObserver(function(g,p){var t=b.getAttribute("data-intersection-action");t&&g.forEach(function(u,y){var v=0;u.isIntersecting&&k&&(v=k.reduce(function(z,E){return Math.abs(E-u.intersectionRatio)<Math.abs(z-u.intersectionRatio)?E:z}));a.triggerAction(t,{element:b,event:{type:"IntersectionObserver",entry:u,index:y,entries:g,observer:p,closestThreshold:v,closestThresholdPercent:100*v,isAbove:u.boundingClientRect.y<
u.rootBounds.y}})})},{root:e.querySelector(m)||null,rootMargin:q||"0px",threshold:k||null})}m=b.getAttribute("data-intersection-target");h[d].iO[b.id].observe(m||b)});e.querySelectorAll("[data-mutation-action]").forEach(function(b){h[d].mO[b.id]||(h[d].mO[b.id]=new MutationObserver(function(t,u){var y=b.getAttribute("data-mutation-action");y&&t.forEach(function(v,z){a.triggerAction(y,{element:b,event:{type:"MutationObserver",mutation:v,index:z,mutations:t,observer:u}})})}));var m="true"==b.getAttribute("data-mutation-child-list"),
q="true"==b.getAttribute("data-mutation-attributes")||!0,k="true"==b.getAttribute("data-mutation-character-data"),g="true"==b.getAttribute("data-mutation-subtree"),p=b.getAttribute("data-mutation-attribute-filter");p=p?p.split(",").map(function(t){return t.trim()}):r("AttributeFilter")||null;m={childList:m,attributes:q,characterData:k,subtree:g};p&&m.assign(m,{attributeFilter:p});p=b.getAttribute("data-mutation-target");h[d].mO[b.id].observe(p||b,m)});var c=e.querySelectorAll("[data-animation-frame-action]");
if(c){h[d].rAFsF=0;var n=function(b){c.forEach(function(m){var q=m.getAttribute("data-animation-frame-action");q&&a.triggerAction(q,{element:m,event:{type:"AnimationFrame",time:b,sceneFrames:h[d].rAFsF++,totalFrames:h[d].rAFtF++}})});h[d].rAFiD=requestAnimationFrame(n)};h[d].rAFiD=requestAnimationFrame(n)}r("WindowEvents").forEach(function(b){var m=e.querySelectorAll("[data-window-"+b+"-action]");m&&(h[d].wE[b]=function(q){var k=q.type;m.forEach(function(g){if(g&&k){var p=g.getAttribute("data-window-"+
b+"-action");p&&a.triggerAction(p,{element:g,event:q})}})},window.addEventListener(b,h[d].wE[b],{passive:!0}))});r("DocumentEvents").forEach(function(b){var m=e.querySelectorAll("[data-document-"+b+"-action]");m&&(h[d].dE[b]=function(q){var k=q.type;m.forEach(function(g){if(g&&k){var p=g.getAttribute("data-document-"+b+"-action");p&&a.triggerAction(p,{element:g,event:q})}})},document.addEventListener(b,h[d].dE[b],{passive:!0}))})}});window.HYPE_eventListeners.push({type:"HypeSceneUnload",callback:function(a,
e,l){var d=a.documentId();e.querySelectorAll("[data-scene-unload-action]").forEach(function(c){var n=c.getAttribute("data-scene-unload-action");n&&a.triggerAction(n,{element:c,event:l})});for(var f in h[d].rO)e.querySelectorAll("[data-resize-action]").forEach(function(c){h[d].rO[f].unobserve(document.getElementById(c.id))});for(f in h[d].iO)e.querySelectorAll("[data-intersection-action]").forEach(function(c){h[d].iO[f].unobserve(document.getElementById(c.id))});for(f in h[d].mO)h[d].mO[f].disconnect();
h[d].rAFiD&&(cancelAnimationFrame(h[d].rAFiD),h[d].rAFiD=null);r("WindowEvents").forEach(function(c){h[d].wE[c]&&(window.removeEventListener(c,h[d].wE[c]),delete h[d].wE[c])});r("DocumentEvents").forEach(function(c){h[d].dE[c]&&(document.removeEventListener(c,h[d].dE[c]),delete h[d].dE[c])})}});window.HYPE_eventListeners.push({type:"HypeSymbolLoad",callback:function(a,e,l){var d=document.getElementById(a.currentSceneId()),f=a.getSymbolInstanceById(e.id).symbolName();if("function"==typeof a.functions()[f])a.functions()[f](a,
e,Object.assign({proactiveEvent:!0},l));a.triggerActionsByAttribute("data-symbol-load-action",d,{event:l});e=x(f);a.triggerActionsByAttribute("data-symbol-load-"+e+"-action",d,{event:l})}});window.HYPE_eventListeners.push({type:"HypeSymbolUnload",callback:function(a,e,l){var d=document.getElementById(a.currentSceneId()),f=a.getSymbolInstanceById(e.id).symbolName();if("function"==typeof a.functions()[f])a.functions()[f](a,e,Object.assign({proactiveEvent:!0},l));a.triggerActionsByAttribute("data-symbol-unload-action",
d,{event:l});e=x(f);a.triggerActionsByAttribute("data-symbol-unload-"+e+"-action",d,{event:l})}});window.HYPE_eventListeners.push({type:"HypeTriggerCustomBehavior",callback:function(a,e,l){var d=l.customBehaviorName;/[;=()]/.test(d)?a.triggerAction(d,{element:e,event:l}):(e=document.getElementById(a.currentSceneId()),a.triggerActionsByAttribute("data-behavior-action",e,{event:l}),d=x(l.customBehaviorName),a.triggerActionsByAttribute("data-behavior-"+d+"-action",e,{event:l}))}});window.HYPE_eventListeners.push({type:"HypeTimelineComplete",
callback:function(a,e,l){e=document.getElementById(a.currentSceneId());a.triggerActionsByAttribute("data-timeline-complete-action",e,{event:l});var d=x(l.timelineName);a.triggerActionsByAttribute("data-behavior-"+d+"-action",e,{event:l})}});var D={version:"1.0.7",getDefault:r,setDefault:function(a,e){"object"==typeof a?w=a:w[a]=e}};return D}());
